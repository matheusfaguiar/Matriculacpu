<!-- resources/templates/usuario/completar-cadastro.html -->
<div th:fragment="content" th:classappend="${isModal} ? '' : 'container py-4'">
  <h2 class="mb-4">Completar Cadastro</h2>

  <form th:action="@{/usuario/completar-cadastro}" th:object="${usuario}" method="post" class="needs-validation" novalidate>
    <input type="hidden" th:field="*{id}" />

    <!-- Inclui os campos do fragmento existente - SINTAXE CORRIGIDA -->
    <div class="row g-3">
      <div th:replace="~{usuario/campos-usuario :: campos-usuario(
          perfis=${perfis}, 
          canEditPerfil=${canEditPerfil}, 
          modalId=${modalId},
          lotacoesDisponiveis=null
        )}"></div>
    </div>

    <!-- CAMPO DE LOTAÇÃO APENAS PARA TÉCNICOS (APENAS LEITURA) -->
    <div class="row g-3" th:if="${showLotacao}">
      <div class="col-12 col-md-6">
        <label class="form-label">Lotação</label>
        <input type="text" 
               class="form-control" 
               th:value="${lotacaoTecnico?.nome}" 
               readonly
               disabled>
        <small class="form-text text-muted">Sua lotação atual (apenas visualização)</small>
      </div>
    </div>

    <!-- Botões -->
    <div class="d-flex justify-content-end flex-wrap gap-2 mt-4 pt-3 border-top">
        <button type="button"
                class="btn btn-secondary"
                th:onclick="|window.location='@{/}'|">
            Cancelar
        </button>

        <button type="submit" class="btn btn-primary">
            Salvar
        </button>
    </div>
  </form>
</div>

